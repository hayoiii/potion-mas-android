# POTION-application-with-MSA

공공데이터 오픈 API를 이용한 마이크로 서비스 아키텍쳐의 안드로이드 어플리케이션



## 1. 프로젝트 개요

개인 맞춤형 건강기능식품 관리 어플리케이션인 포션은 공공데이터를 이용하여 식품의약안전처에 등록되어있는 건강기능식품을 검색하여 상세 정보를 손쉽게 확인 할 수 있는 서비스이다. 또한, 사용자가 복용 중인 제품을 등록하여 관리할 수 있으며, 식품의약안전처에 등록되어 있지 않은 품목이라도 사용자가 직접 정의하여 등록할 수 있도록 하여 통합적인 관리가 가능하다. 보통 건강기능식품 뒷면에 나와있는 성분들에 대한 정보는 알기 쉽지 않으며 복약 시 주의해야 할 사항을 놓치기 쉽기 때문에 성분 검색 서비스도 제공한다. 이 보고서에서 언급하는 ‘포션’은 사용자가 저장한 건강기능식품 또는 사용자 정의 아이템을 뜻한다.


## 2.	어플리케이션의 기능 명세

- 검색 기능
  - 건강기능식품 검색:	식약청에 등록되어 있는 건강기능식품을 이름으로 검색하고 해당 아이템의 상세 정보를 보여준다.
  - 건강기능식품의 성분 검색:	성분을 이름 또는 효능으로 검색하고 해당 성분의 상세 정보를 보여준다.

- 복용 중인 건강기능식품 등록 및 관리	
  - 건강기능식품을 내 포션으로 등록:	등록할 아이템에 별칭, 먹기 시작한 날짜, 메모, 일주일에 몇 일 몇 회씩 먹는 지와 함께 등록해 놓을 수 있다. 이 아이템들은 메인 화면에서 관리가 가능하다.
  - 사용자 정의 포션 등록:	식약청에 등록되있지 않은 건강기능식품이나 다른 제품들도 제품명, 제조사, 효과, 섭취 방법, 주의사항 및 메모와 함께 등록해 놓을 수 있다. 이 아이템들은 메인 화면에서 관리가 가능하다.


## 3. 시스템 설계

### 3.1 아키텍쳐
![아키텍쳐](https://user-images.githubusercontent.com/66769242/120964550-75cc1000-c79e-11eb-89d9-af39bf6527c0.png)

### 3.2 데이터베이스 
#### MongoDB - AWS EC2 
![image](https://user-images.githubusercontent.com/66769242/120966470-3ce16a80-c7a1-11eb-94e1-363243b90d8a.png)

#### SQLite - 로컬 스토리지
사용자가 복약 관리를 위해 추가한 '내 포션'을 저장함.
![image](https://user-images.githubusercontent.com/66769242/120967504-79fa2c80-c7a2-11eb-9435-182994d14876.png)


### 3.3 공공데이터 오픈 api 명세
#### 1. 건강기능식품 서비스

파라미터:  Prduct(제품명, 사용자가 입력한 검색의 키워드), pageNo(페이지번호)
- 건강기능식품 검색 액티비티에서 사용자가 검색한 키워드가 이름에 포함된 건강기능식품의 리스트를 받아오는 데 사용한다.
- 응답의 **제품명**과 **제조업체명**은 리스트의 아이템을 표시하는 데 활용한다.
- 응답의 **품목제조관리번호**는 해당 건강기능식품의 상세 정보를 받아오는 ‘건강기능식품 품목제조신고’ API의 요청 변수로 사용한다.


#### 2. 건강기능식품 품목제조신고

파라미터: PRDLST_REPORT_NO(품목제조관리번호, 상세 정보를 가져올 건강기능식품의 고유한 일련번호. ‘건강기능식품 서비스’의 응답으로 받아옴)
- 건강기능식품 검색의 결과로 나온 리스트의 아이템을 클릭 했을 때 해당 건강기능식품의 상세 정보를 가져와 보여주는 것에 사용한다.
- 사용 할 데이터: 업소명, 품목명, 성상, 섭취방법, 주된 기능성, 섭취 시 주의사항, 보관방법, 원재료


#### 3. 건강기능식품 품목분류정보

파라미터: dataType(xml or json, MongoDB에 저장할 것이므로 json타입으로 응답 받기), startIdx(요청시작위치), endIdx(요청종료위치)
- MongoDB에 Document로 저장 할 데이터를 받아옴.
- 성분 검색 시 성분에 대한 상세 정보를 제공한다. 
- 사용 할 데이터: 성분명, 섭취 시 주의사항, 주된 기능성, 일일섭취량 하한, 일일섭취량 상한, 단위, REMARK, 원재료명, 최초 등록일, 최종 수정일

### 3.4 AWS Lambda 명세 - potion-server, getMaterialInfo
런타임: Node.js 12.x

Trigger: API Gateway PotionAPI

MongoDB 라이브러리: mongoose


### 3.5 AWS API Gateway 명세 - PotionApi
![image](https://user-images.githubusercontent.com/66769242/120966146-c80e3080-c7a0-11eb-8af3-1157e4a6c346.png)

#### customized 리소스: potion-server Lambda 함수를 호출
- POST: 새로운 사용자 정의 포션을 MongoDB에 저장.
- GET: MongoDB에 저장되어 있는 모든 사용자 정의 포션 데이터를 리스트로 리턴함.
- PATCH: MongoDB에 기존에 저장되어 있던 사용자 정의 포션 정보를 업데이트.
- DELETE: MongoDB에 기존에 저장되어 있던 사용자 정의 포션 정보를 삭제.

#### material 리소스: getMaterialInfo Lambda 함수를 호출
- GET: MongoDB에 저장된 성분 데이터 중에서 사용자가 검색한 키워드를 **성분명** 또는 **효능**에 포함하고 있는 모든 데이터를 리스트로 리턴함.
